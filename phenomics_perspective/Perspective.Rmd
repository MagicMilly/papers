---
title: Predicting Phenotype from Multi-Scale Genomic and Environment Data using Neural
  Networks and Knowledge Graphs
author: "Ryan Bartelme"
output: pdf_document
fontsize: 12pt
geometry: margin=1in
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tinytex)
library(yaml)
```
  During this period of unprecedented anthropogenic climate change, understanding genomic response to environmental variation and the influences on organismal phenotypes is critical.
Predicting these responses is invaluable to maintain the innumerable services natural ecosystems provide. 
Multiscale effects over time and space combined with the non-linearity of natural systems (Lorenz, 1963; Ruel & Ayres, 1999; West et al., 2009) obscures the signal of biological processes, their interactions with the environment, and resulting observable phenotypes (Figure 1).

  Existing models for predicting phenotypes from genetic and environmental data focus on single species or single ecosystems.
As we enter an era of Big Data in ecological research (Balch et al., 2020), ecologists are shifting away from relatively small data sets toward national and global efforts such as the National Ecological Observatory Network (NEON) (Keller et al., 2008) and airborne and space-based Earth Observation Systems (EOS). 
Both societal need and technical capabilities are moving toward addressing larger scale questions that require integration of multi-modal data and non-linear predictive models to understand the interactions between an organism’s genetic potential and its environment and how those interactions result in observable phenotypes.

  Incorporating genomic data into phenomics is challenging. Many recent studies have used only environmental features and machine learning to predict phenotypes of lilacs, honeysuckle, rice, and wheat (Alderman & Stanfill, 2017; Nissanka et al., 2015; Poor, 2019). 
There are a number of methods linking genomic data to environments or traits. 
For example, genome wide association studies (GWAS) enable researchers to examine the influence of single nucleotide polymorphisms (SNP) on phenotypes in both natural and controlled settings (Beyer et al., 2019; Schläppi et al., 2017; Spindel et al., 2016). 
GWAS often provides generalized and mixed linear model associations between SNPs and environmental variables, roughly analogous to Genes + Environment = Phenotype (G+E=P). 
There are limitations in the assumptions made by existing methodologies, such as GWAS, that directly attribute plant phenotypes to environmental variables. 
These methods do not explicitly incorporate biological and molecular interactions, such as post-translational modification of macromolecules (Running, 2014), the importance of plant-microbe interactions (Oyserman et al., 2019), or endogenous siRNA (Katiyar-Agarwal et al., 2006). 
However, our machine learning approach allows for these biological phenomena to be accounted for as latent variables while probing the interactions of Genomes+Environments=Phenomes in a multidimensional manner. 

  Conventional observations and statistical models are shifting toward remotely sensed observation and trait collection, which rely on machine learning (ML) and computer vision for measurements. 
For example, Bayesian Belief Networks (G. F. Cooper, 1990) may be implemented to associate environmental variables with traits, and Generative Adversarial Networks (Radford et al., 2016) for classifying plant phenotype imaging. 
Rather than simply generating large quantities of machine readable data (Hampton et al., 2013) and implementing ML methods ad-hoc (Pichler et al., 2019), ecologists are now grappling with how to interpret the massive quantities of unstructured data that are available at scale.  
ML predictions often rely on complex, “black box” methodologies to assess explanatory variables. 
Here we introduce the GenoPhenoEnvo project, an effort to predict phenotype from genetic and environmental data, while developing novel representations of the ML “black-box” internals. 

  Our project has the long-term goal of developing predictive analytics based on an organisms’ genetic code and its associated phenomic response to environmental change. 
To design an initial analytical framework and workflow, we will first use phenomic, genomic, and environmental data about sorghum (Sorghum bicolor). 
These data are available through the TERRA-REF (Transportation Energy Resources from Renewable Agriculture Phenotyping Reference Platform) project (Andrade-Sanchez et al., 2014). 
After training the ML model on the highly controlled and thorough TERRA-REF data set, we aim to test and further develop the model with data from less controlled and lower resolution environments using data from sources such as NEON and the Global Phenology Network. 

  The first challenge is to prepare these data for use as input into ML models. In addition to empirical data, ontologically-supported knowledge graphs can be used to inform the ML (Mungall et al., 2017). 
Knowledge graphs (KG) are directed acyclic graphs that represent knowledge in a computational format and are an integral part of Google’s Answer Box and IBM’s Watson.
KGs can help constrain and prioritize results, provide quality control, fill in data gaps with inferencing, and integrate heterogeneous data. 
In this project, KGs  provide an easier way to integrate data from established plant phenome databases such as Planteome (L. Cooper et al., 2018), Gramene (Jaiswal, 2011), and TAIR (Poole, 2007). 
The true power of ontologies and KGs is a formal logical structure, enabling inferential and similarity analyses (Mungall et al., 2016; Washington et al., 2009).
In particular, it is this latter feature that will enable data set interoperability.
As we begin to make predictions in more complicated systems with multiple species and heterogeneous data, the knowledge graphs will be critical for managing phenotype data.

  The GenoPhenoEnvo (GPE) project aims to predict phenotype with genomic and environmental data using a multimodal approach to training ML models. 
We are actively developing a visualization tool to increase understanding of why the model gave a particular result. 
In this way, the GPE project will work toward phenotype predictions and an increased understanding in the biological and molecular processes that translate genotype to phenotype.
In addition to increased awareness of molecular effects, the ML models could enable specific ecological hypothesis testing or predicting long-term speciation events driven by environmental factors. 
Ultimately, we believe this combination of methods will generate a new scientific subdiscipline, one we have called “Computational Ecogenomics.”




